# Trace glass evidence: chemical composition  {#glass}

#### *Authors* {-}


![Source: https://www.pexels.com/photo/black-and-white-broken-dark-glass-235727/](img/brokenglass.png)

## Introduction

It is easy to imagine a crime scene with glass fragments: a burglar may have broken a glass door, a glass bottle could have been used in an assault, or a domestic disturbance may involve throwing something through a window. There are many ways that glass can break and that glass fragments can be transferred. The study of glass fragments is important to forensic science because the glass broken at the scene can transfer to the perpetrator's shoes or other clothing, or even their hair [@curranbook].  

Crime scene investigators collect fragments of glass at the scene as a part of the evidence collection process and the fragments are sent to the forensics lab for processing. Similarly, evidence such as clothing and shoes are collected from a suspect, and if glass is found, the fragments are compared to the fragments found at the scene. The question that the analyst usually tries to answer is, "Did these glass fragments come from the same source?" This is a *source level* question, meaning that the comparison of the fragments will only tell the investigators whether or not the person came in contact with the broken glass at the scene. It will not tell them *how* they came into contact (*activity level*) with the glass or if they committed the crime (*offense level*) [@hop].  



### Question of interest
There could be two questions of interest in glass fragments comparison; (1) The specific source problem, whether the questioned fragment ($Q$) is from the lass pane that known fragments ($K$) found at the crime scene, (2) the common source problem, whether the questioned fragment ($Q$) share the source that known fragment belong to.  Regardless of which question we are facing, the statistic we need to help answer the question is the similarity between $Q$ and $K$. There are lots of ways to define the similarity between two glass fragments, $Q$ and $K$ but it should be defined based on the what types of data or measurements we have for glass fragments. For example, if we have a elemental compositions measured in ppm and they are numerical values, the easy version of similarity would be the differneces of numerical values between $Q$ and $K$. 


### current practice
There are many types of glass measurements such as color, thickness, refractive index (RI) and chemical concentrations. In this study, we will focus on the float glass that is most frequently used in windows, doors and automobiles. Also, the measurements of float glass are obtained through inductively coupled mass spetrometry with a laser add-on (LA-ICP-MS). In this situation, there are two kinds of forensic comparison guidance by ASTM International; [@ASTME233012, @ASTME292716]. The rule to classify glass fragments in the standard methods is constructed by interval based appoach on each of chemical element. 


### goal of this chapter
In this chapter, we will show how to construct the rule using random forest algorithm to classify the source of glass fragments [@park2018]. 




## Data 
### Comparing glass fragments 

In order to determine if two glass fragments come from the same source, a forensic analyst considers many properties of the glass, including color, fluorescence, thickness, surface features, curvature, and chemical composition. All methods for examining these properties, except for methods of chemical composition analysis, are non-destructive. If the fragments are large, exclusion are easy to reach if the glass are of different colors because of the wide variety of glass colors possible in manufacturing. Typically, however, glass fragments are quite small and color determination is very difficult. Similarly, thickness of glass is dictated by the manufacturing process, which aims for uniform thickness, so if two glass fragments differ in thickness by more than 0.25mm, an exclusion is made [@glassbackground]. For glass fragments of the same color and thickness, microscopic techniques for determining light absorption (fluorescence), curvature, surface features (such as coatings), are used before the destructive chemical composition analysis. 

### Chemical composition of glass 

The process for determining the chemical composition of a glass fragment is given in great detail in @ASTME233012 and @ASTME292716. This destructive method determines elemental composition with Inductively Coupled Plasma Mass Spectrometry (ICP-MS). Up to 40 elements can be detected in a glass fragment using this method. In @weisglass, only 18 elements are used: calcium, sodium and magnesium are the major elements, followed by aluminum, potassium and iron as minor elements, and lithium, titanium, manganese, rubidium, strontium, zirconium, barium, lanthanum, cerium, neodymium, hafnium, and lead as the trace elements. The methods of @weisglass use standard deviations ($\sigma$) of repeated measurements of the same fragment to create intervals around the measurements. Intervals of width $2\sigma, 4\sigma, 6\sigma, 8\sigma, 10\sigma, 12\sigma, 16\sigma, 20\sigma, 30\sigma,$ and $40\sigma$ are considered for overlap. 


### Data source

CSAFE have collected float glass data on the chemical composition of float glass samples, where the details of these dataset are explained in @park2018. These data were collected as part of an effort to construct a dataset to be put in the public domain. The dataset includes 31 panes of float glass manufactured by Company A and 17 panes manufactured by Company B, both located in the United States. The Company A panes are labeled AA, AB, ... , AAR, and the Company B panes are labeled BA, BB, ... ,BR.  The panes from Company A were produced within 3 weeks (Jan. 3 - Jan. 24, 2017) and the panes from Company B were produced within 2 weeks (Dec. 5 - Dec. 16, 2016). To understand variability within a ribbon of glass, two glass panes were collected on almost all days in each company, one  from the left side and one from the right side of the ribbon. Twenty four fragments were randomly sampled from each glass pane. Five replicate measurements were obtained for 21 of the 24 fragments in each pane; for the remaining three fragments in each pane, we obtained 20 replicate measurements. Therefore, each pane has 165 measurements for 18 elements.  In some panes, there may be a fragment with fewer than five replicate measurements.  The unit for all measurements is parts per million (ppm).


## R Package(s)

<!--caret package to fit the data to random forest on cross-validation--> 

R package called 'caret' is used for getting random forest classifier for the source prediction of glass fragments. 

To begin, the package can be installed from CRAN:

```{r, eval=FALSE}
install.packages('caret')
```

```{r, message=FALSE, warning=FALSE}
library(tidyverse)
library(caret)
library(ggplot2)
```

R package 'caret' is useful for developing machine learning algorithms with cross-validations. (BLAH....)


We propse a computer-assisted method to quantify the similarity between two glass fragments $Q$ and $K$. The goal here is to construct the classifier that predicts the source of $Q$ and $K$ well when there is two kinds of sources; same source and different source. Imagine that we have many glass fragments. By constructing many pairwise differences between glass framgents, we will record their source either same source or different source. 

Here are steps:

1. Take log transformation of measurements of all glass fragments.
2. Select one fragment from the pane A and call it $Q$. 
3. Select another fragment from the pane A and call it $K$.
4. Take the difference between mean of $Q$ and the mean of $K$ across all repeated measurements in each fragment. 
5. We have a response variable for selected $Q$ and $K$ as the 'same source', since $Q$ and $K$ are from the same source.
6. We change the pane A into different pane in stage 3, to construct the pairwise differences for the response variable of 'different source'.

Once we have got many pairwise differences with response variable of 'same source' and 'different source', we will train random forest to understand the property of two classes of the source. 


```{r dat}
glass<-read.csv('dat/glass_raw_all.csv')
names(glass)[4:21] <- str_sub(names(glass)[4:21], 1,2)
names(glass)[8] <- "K"
dim(glass)
head(glass[,c(22,1:8)],10)
summary(glass[,4:8])
```


We see that fragment 1 and 2 from pane AA and manufatruer A are measured 5 times each. As an example, we show five chemical measurements of lithium (Li7), sodium (Na23), magnesium (Mg25), aluminium (Al27) and potassium (K39). Each chemical concentration has different scale; for example, lithium ranges from 0.415 to 7.7 while sodium ranges from 53700 to 111910. Thus, we take log transformation of entire measurements. 

```{r dat2}
glass_long <- glass %>% gather(element, ppm, Li:Pb)
glass_log_long<- glass_long %>% mutate(log_ppm=log(ppm))
glass_log_long[,-6] %>% spread(element, log_ppm) %>% select(mfr,pane,fragment,Rep,Li,Na,Mg,Al,K) %>% head()
```






## Drawing Conclusions

## Case Study
Test a new pair of comparisons using AOAS random forest classifier. 


